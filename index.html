<html>
<head>
<title>Madras Music & Miscellany</title>
 
<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
<script type="text/javascript" src="cordova.js"></script>
	 
	<link class="jsbin" href="css/jquery-ui.css" rel="stylesheet" type="text/css"></link>
<link rel="stylesheet" href="css/styles.css"></link>
<link rel="stylesheet" href="css/slide-and-swipe-menu.css"></link>
 
 
<script class="jsbin" src="js/jquery.min.js"></script>
<script src="js/jquery-ui.min.js"></script>
<script src = "js/jquery-ui.js"></script>
<script src="js/jquery.touchSwipe.min.js"></script>
<script src="js/jquery.slideandswipe.min.js"></script>
  <script src="https://maps.googleapis.com/maps/api/js"></script>
<script src="http://maps.google.com/maps/api/js?sensor=false"></script>  
  <script type="text/javascript" src="Calendar.js"></script>
 

  
    <style type="text/css" media="screen"> 
	    
	    #cat_tbl span { 
		    display: inline-block;
  vertical-align: middle;
  margin-left: 60px;  /* width of image */
   font-size: 15px;
		    
		    
	    }
	
#input1:focus 
	    {
	     outline: none !important;
    border:0px solid white;
     
	    }
	    
	    span.deleteicon {
                position: relative;
            }
            span.deleteicon span {
                position: absolute;
                display: block;
                top: 5px;
                right: 0px;
                width: 16px;
                height: 16px;
                background: url('clear_cross.png') ;
		background-repeat: no-repeat;
                cursor: pointer;
            }
            span.deleteicon input {
                padding-right: 0px;
                box-sizing: border-box;
            }
	    
	    
 .chartme-btn-main
{
    background: url('fav.png')  no-repeat;
	padding: 1em;
	border: 0;
	background-color: transparent;
border-top-style: none;
border-right-style: none;
border-bottom-style: none;
border-left-style: none;
}
.arrowdown
{
    background: url('fav_red.png')  no-repeat;
padding: 1em;
	border: 0;
	background-color: transparent;
border-top-style: none;
border-right-style: none;
border-bottom-style: none;
border-left-style: none;
}          
	    
	    #main {
	   max-width: 1200px;
margin: 0 auto;
	    }
#wrapper {
	 
	 width: 100%;
margin: 0 auto;
  display: flex;
	padding-top: 8px;
	padding-bottom: 8px;
	
}
#left {
  flex: 0 0 35%;
	 width: 50%;
   background: white;
	text-align: center;
	 font-family: 'Open Sans';
	font-size: 10pt;
	 display: inline-block;
	  vertical-align: bottom;
	padding-top: 5px;
	 
	 
}
#right {
  flex: 1;
   background: white;
	 width: 50%;
	font-size: 9pt;
	font-family: 'Open Sans';
	 display: inline-block;
	padding-left: 3px;
	padding-top: 5px;
}
	 #right_most {
  flex: 1;
   background: white;
	 width: 10%;
	font-size: 9pt;
	font-family: 'Open Sans';
	 display: inline-block;
	padding-left: 3px;
	padding-top: 5px;
}
    h1 { font-size: 20pt; color:Navy; }
    h2 { font-size: 18pt; font-weight:bold; color: #DDD; }

  /*  body { background-color: #FFF; font: 16px Helvetica, Arial; color: #000; }
    body { margin:0; padding:0; height:100%;}*/

 /*   .ui-widget { color: gray;font-size: 0.8em; line-height:0.8em; }
    .ui-widget .ui-widget { font-size: 0.8em; }*/

    
	    
	    .artDisplay
	    {
	    display: none; 
	    }

	   


	 nav[role="main"] ul {
          margin: 0;
	  color:#cfddfa;
          padding: 2%;
          list-style: none;
		  
      }
     nav[role="main"] ul li {
          margin: 0;
	    color: white;  
	      text-align: center; 
	     font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;
		  
      }
      nav[role="main"] ul li a {
          padding: 15px 20px;
          font-size: 13px;
          font-weight: 100;
          color: white;
          text-decoration: none;
          display: block;
          border-bottom: 1px solid #3b6f8a;
	font-family: "Lucida Sans Unicode", "Lucida Grande", sans-serif;		;   
          -webkit-transition:  background 0.3s ease-in-out;
          -moz-transition:  background 0.3s ease-in-out;
          -ms-transition:  background 0.3s ease-in-out;
          -o-transition:  background 0.3s ease-in-out;
          transition:  background 0.3s ease-in-out;
      } 	
      nav[role="main"] ul li:hover a {
          background: #3b6f8a;
      }


	  nav[role="sub"] ul {
          margin: 0;
	      color:#cfddfa;
          padding: 2%;
          list-style: none;
		  
      }
      nav[role="sub"]  ul li {
          margin: 0;
	    color: white;  
	      text-align: center; 
		  
      }
      nav[role="sub"]  ul li a {
           padding: 15px 20px;
          font-size: 13px;
          font-weight: 100;
          color: white;
          text-decoration: none;
          display: block;
          border-bottom: 1px solid #3b6f8a;
			   
          -webkit-transition:  background 0.3s ease-in-out;
          -moz-transition:  background 0.3s ease-in-out;
          -ms-transition:  background 0.3s ease-in-out;
          -o-transition:  background 0.3s ease-in-out;
          transition:  background 0.3s ease-in-out;
      } 	
      nav[role="sub"] 	 ul li:hover a {
          background: #3b6f8a;
      }
	  
		
		body, html {
    width: 100%; !important;
    height: 100vh;
    margin: 0;
    padding: 0;
    overflow-x: hidden;
}
	    
	    
	   
	  
	    
.btn24
	
	{
	width:100%;
	height:100%;
	background-color:#f2f2f2; border:block; padding: 2;  display:inline-block; font-weight: bold; color: black;
	border-radius:6px;
    -moz-border-radius:6px;
	}
.names { font-weight: bold; 
		text-align:left;}

		.ven_cal
		{
		 width: 100vw;
		font-size: 8pt;
			background-color: #eeedf0;
    border-color: #eeedf0;
	  border-collapse:separate;
 
/*    border-radius:6px;*/
  /*  -moz-border-radius:6px;*/
		}
		
		
.ven
{
width: 100vw;
text-align:center; 
	
/*			border-style: solid;*/
  /*  border-color: black;*/
		}
.ven1
		{
		 width: 100vw;
		font-size: 11pt;
			 
	  border-collapse:separate; 
	 
/*   padding-left:6px;*/
/*    border-radius:6px;*/
  /*  -moz-border-radius:6px;*/
		}
.ven2
		{
		 width: 100vw;
			  
			border-style: solid;
			font-size: 9pt;
 */   border-color: black;*/
	  border-collapse:separate;
   */ border:solid black 1px;*/
    border-radius:6px;
    -moz-border-radius:6px;
		}	
.hideDontTakeUpSpace
        {
            display:none;
        }

.btn1 {  background-color: transparent; border:none; padding: 0; font-weight: bold; color: white; text-decoration:underline;
    display:inline-block;}
.btn24
	
	{
	width:100%;
	height:100%;
	background-color:#f2f2f2; border:block; padding: 2;  display:inline-block; font-weight: bold; color: black;
	border-radius:6px;
    -moz-border-radius:6px;
	}
		 	
.btn34 {  background-color: #0c9db7; border:none; padding: 11px 11px 11px 11px; font-weight: bold; color: white; border-radius: 5px;font-family:  Arial, Helvetica, sans-serif; }		
		
.btnSrch {  display:inline-block;   text-decoration:none;}	
.btn2 {  background-color: transparent; border:none; padding: 0; font-weight: bold; color: black;}
button:focus {outline:none;} ::-moz-focus-inner {border:0;}
#evtcal a:link {font: normal 12pt "Arial", "Helvetica", "Sans Serif"; color: #004400; text-decoration: none;}		/* unvisited link */
#evtcal a:visited {font: normal 12pt "Arial", "Helvetica", "Sans Serif"; color: #004400; text-decoration: none;}	/* visited link */
#evtcal a:hover {font: normal 12pt "Arial", "Helvetica", "Sans Serif"; color: #004400; text-decoration: underline;}	/* mouse over link */
#evtcal a:active {font: normal 12pt "Arial", "Helvetica", "Sans Serif"; color: #004400; text-decoration: none;}		/* selected link */
#lst_mnu
	{
		display:none;
		text-align:center;
		 max-width: 1200px;
		margin: 0 auto;
                width: 100% !important;
    height: 100vh;
		
	}
#lst_mnu table {
    
    width: 100% !important;
   border-color: black; 
	font-family: "Sans Serif"; 
	font-size: 9pt; 
  }
		
.cat
	{
  max-width: 400px;
    width: 100% !important;
}
	#evt_lst
	{
		display:none;
		height: 100vh;
		
	}
	.map_c
	{
		 width: 100vw;
	}
		
		
		 #middlecol {
    border-right: 2px solid red;
    width: 45%;
  }

  #middlecol table {
    max-width: 400px;
    width: 100% !important;
  }
#xPort
	{
		
		 max-width: 1200px;
		margin: 0 auto;
                width: 100% !important;
		display:none;
		font: 15px arial, sans-serif;
		/*background-color:  #f8f9fb;*/
/*		font-family: "Sans Serif";*/
	/*	font-size: 9pt;*/
	/*	font: normal 12pt "Sans Serif";  */
		}
#xPort1
	{
		
		display:none;
		 
		}
	    
	    #map-container{
 position: relative; 
}

#map{
   width: 100vw;
	display:none;
	 
}
	    

/* The following is just coloring and faux images */

.dl_btn {
    width: 100% !important;
     background:#f3f3f3;
	display: none;
}

.dl_btn1 {
   
	display: none;
}				
		div.tab {
    overflow: hidden;
    border: 0px solid #ccc;
    background-color:  #0c9db7;
    width: 100% !important;
    height:50px;
	    
	  
}
		
 
/* Style the buttons inside the tab */
div.tab button {
    
   background-color: inherit;
    float: left;
    border: none;
    outline: none;
    cursor: pointer;
    padding: 14px 16px;
    transition: 0.3s;
    font-size: 13px;
    color: white;
    border-left:solid white 0px;
    border-right:solid white 0px;
    border-top:solid white 0px;
    border-bottom:solid #0c9db7; 3px;
    background:#0c9db7;
    width:33%; height:50px
}

/* Change background color of buttons on hover */
div.tab button:hover {
    /*  background-color: #ddd;*/
    border-bottom:solid white 4px;
}

/* Create an active/current tablink class */
div.tab button.active {
     /*  background-color: #ccc;*/
     border-bottom:solid white 4px;
}

/* Style the tab content */
.tabcontent {
     display: none;
    padding: 3px 12px;
 /*   border: 1px solid #ccc;*/
    border-top: none;
}

/* Style the close button */
.topright {
    float: right;
    cursor: pointer;
    font-size: 20px;
}

.topright:hover {color: red;}

#div_hr
{
	display	: none;
		} 
		
.style1{
/*border-top: 1px solid #8c8b8b;*/
display	: none;
}
		
		#calEvent
		{
		
			width: 100vw;
			
			font-size: 9pt;
     

     display:none;
		
		}
		 
	
		@media screen and (min-width: 100px) and (max-width: 199px)
{
    .button
    {
        width: 25px;
    }
}

@media screen and (min-width: 200px) and (max-width: 299px)
{
    .button
    {
        width: 50px;
    }
}
		
.left-div {
		 border-radius: 25px;
    float: left;
    width: 50vw;
    height: 20px;
    background-color: linen;
/*    margin-right: 8px;*/
  
}
.right-div {
 /*   margin-left: 108px;*/
	 width: 50vw;
	 border-radius: 25px;
	background-color: green;
    
}
.category
		{
		 
      height: 100vh;
	width: 100%;	
   position: fixed;
  left: 1%;
 text-align: left;
}
#calendar
		{
		 
		display	: none;
   
}		

	   
	    
	
		.left1 {
         width:50%;
         border-right:1px solid #000000;
        float:left;
        height:70px;
	padding-left:6px;
    }
   .right1 {
       float:left;
       padding-left:50%;
       
	   height:40px;
   }
   
   .common1 {
        width:100%;
         float:left;
         
   }
	.alt-color tr:nth-child(3n) {
             background-color: #b4c5d3;
		
        }	
	.ven1 tr:nth-child(2n) {
      /*       background-color: silver;*/
		
        }
/*	.ven1 tr:nth-child(odd) {
    background: silver;
}*/
	.login
{
   display:none;
   text-align:center;
}	
.backmenu
{
   display:none;
	 
    
}
		
		.updFile
		{
		 
		display	: none;
   
}
		.csv
{
		 
		display	: none;
   
}		
.archive
{
		 
display	: none;
 
}
.wide {
    display:block;
    width:0px;
    height:0px;
}		
.fake-input { position: relative; width:240px; }
.fake-input input { border:none: background:#fff; display:block; width: 100%; box-sizing: border-box }
.fake-input img { position: absolute; top: 2px; right: 5px }	

.searchmenu
{
  position: relative;
    width: 100%;
	 display:none;
    
}	
   .inputDiv
    {
	    position: relative;
    left: 10px;
    width: 300px;
	    height: 40px;
	    background-color: #f6f7f7; 
 
   }	    
		    
		    
		    
.nav1
	    {
	    display:none; 
	    }
    </style>
	<script>
		  $(document).ready(function() {
                $('input.deletable').wrap('<span class="deleteicon" />').after($('<span/>').click(function() {
                    $(this).prev('input').val('').trigger('change').focus();
                }));
            });
		
		$(document).ready(function() {
			
			});
 var directionsService = new google.maps.DirectionsService();
 var u_name;
	$(document).ready(function() {
	   
	 var u_name= window.localStorage.getItem("key");
	 
	 	//alert('unam'+u_name);
     
 
 if(u_name ==null){                   
         $('nav[role="main"]').slideAndSwipe();     
  }  
 	else
 	{
 $('nav[role="sub"]').slideAndSwipe();
 }
		 
	
            });


	var active_page;
  var optSel;
var usrauth ;	
	usrauth='';	


	var wordlist=new Array();
	function prep()
	{
//	eventsNew="Bombay Chanakya,Crazy Mohan,Bombay Sri Chankya ,U.ve Sri M.v.ananthapadmanabha Swamy ,U.ve Sri M.v.ananthapadmanabha Swamy ,U.ve Sri M.v.ananthapadmanabha Swamy ,Sri P.muthukumaran ,Smt. Subhalakshmi Krishnamoorthy,Bombay Chanakya,Bombay Chanakya,Bombay Jayashree,Mambalam Sisters,Trichur Brothers,Bombay Sisters";
	// alert('in');

//var uniqNew=new Array();

//eventsNew=eventsNew.split(',');
//for (var i = 0; i<eventsNew.length; i++) {
//  uniqNew.push(eventsNew[i]);
//}
 wordlist= remove_duplicates_safe(artistArr);
 wordlist.sort();
	}

 function remove_duplicates_safe(arr) {
    var seen = {};
    var ret_arr = [];
    for (var i = 0; i < arr.length; i++) {
        if (!(arr[i] in seen)) {
            ret_arr.push(arr[i]);
            seen[arr[i]] = true;
        }
    }
    return ret_arr;
}

 

     

    function addMessage(msg){
     //   $('#msgs').append(msg);
    }
function pop(div) {
document.getElementById(div).style.display = 'block';
document.getElementById(div).style.visibility="true";	
}
function hide(div) {
document.getElementById(div).style.display = 'none';
document.getElementById(div).style.visibility="false";	
}
		
$("#input1").keypress(function(){
	 $('#inpu1').css('border', '0px solid #11b818');
	 $('#inpu1').css('border-bottom', '0px dotted blue');
	  
     $('#artist').trigger('click');
});
		
$(document).ready(function(){
		$("#artist").click(function(){
			activePg=2;
	//	  $('#arSrch').show();	 
		$("#arSrch").html("");
		  $('#main').hide();
		  $('#mainMenu').hide();
		  $('#category').hide(); 
			$('#archive').hide();
			$('#map').hide();
		 $('#calendar').hide();
		  $('#dl_btn').hide();
		  $('#lst_mnu').hide();
			$('#backmenu').show();	
			$('#dl_btn1').hide();
			 $('#xPort').hide();
			  $('#xPort1').hide();
			   $('#tab').hide();
		//	hide('main');
		//	hide('backmenu');
		//	hide('category');
		//	hide('dl_btn');
		//	hide('dl_btn1');
		//	hide('mainMenu');
		//	hide('xPort');
		//	hide('xPort1');
		//	hide('tab');
		
		prep();
              //alert(wordlist);

			pop('searchmenu');
			 
				 monkeyPatchAutocomplete();

          $("#input1").autocomplete({
		 
              // The source option can be an array of terms.  In this case, if
              // the typed characters appear in any position in a term, then the
              // term is included in the autocomplete list.
              // The source option can also be a function that performs the search,
              // and calls a response function with the matched entries.
		  
              source: function(req, responseFn) {
                 // addMessage("search on: '" + req.term + "'<br/>");
		        $('#dl_btn').hide();
		$("#xPort").html("");
                  var re = $.ui.autocomplete.escapeRegex(req.term);
				  var matcher = new RegExp( "^" + re, "i" );
				    
                  var a = $.grep( wordlist, function(item,index){
                      //addMessage("&nbsp;&nbsp;sniffing: '" + item + "'<br/>");
                      return matcher.test(item);
                  });
                //  addMessage("Result: " + a.length + " items<br/>");
                  responseFn( a );
              },

              select: function(value, data){
                  if (typeof data == "undefined") {
                  //    addMessage('You selected: ' + value + "<br/>");
			  alert('out');
				//	  document.getElementById('reslt').value=data.item.value;
                  }else {
                   //   addMessage('You selected: ' + data.item.value + "<br/>");
			 
			   
    			//document.activeElement.blur();
    				
 
			  displayResults(data.item.value);
				//	   document.getElementById('reslt').value=data.item.value;
                  }
              }
          });
			});
			
});	

function monkeyPatchAutocomplete() {
		  $('#dl_btn').hide();
	$("#xPort").html("");
          // Don't really need to save the old fn, 
          // but I could chain if I wanted to
          var oldFn = $.ui.autocomplete.prototype._renderItem;

          $.ui.autocomplete.prototype._renderItem = function( ul, item) {
              var re = new RegExp("^" + this.term, "i") ;
              var t = item.label.replace(re,"<br><span id='arSrch' style='display:inline-block; color:black;vertical-align:top ;text-align: center;'>" + this.term + "</span>");
              return $( "<li></li>" )
                  .data( "item.autocomplete", item )
   // .append( "<a><img src='search1.png' style='   vertical-align: middle;  '>" + t + "</a>" )
		  
		  .append( "<table border=0 cellpadding=0 cellspacing=0><tr bordercolor=white><td valign='bottom'><a><img src='search1.png' style=' vertical-align: bottom;' >" +  "</td><td><img src='blank.png'  ></td><td valign='top'>" + t + "</a></td></tr></table>" )
                  .appendTo(ul);
          };
      }


		
		
function displayResults(artistNam)
{
$("#input1").blur();
$("#arSrch").hide();
$('#xPort').show();	
$('#map-container').hide();
$('#map').hide();
$('#det').hide();
$('#calendar').hide();
$('#dl_btn').show();		
// document.getElementById('map').setAttribute("class","wide");
document.getElementById('xPort').innerHTML='' ;
	
var artEvt ='';
	var artEvtDetails='';
//alert(artistNam);
	var art_lst='';
var art_lst="<table border='0' id='test' class='ven1' cellpadding='0' cellspacing='0'>";
art_lst+="<tr height='40px' bgcolor='white'><td colspan=3 align='center'><b>"+  artistNam +"</b></td></tr>";
for (var i = 0, len = events.length; i < len; i++)
{
	 
	if(events[i][8]==artistNam)
		{
			
			hours=String(events[i][4]);
			var timeString = hours;
			var H = +timeString.substr(0, 2);
			var h = H % 12 || 12;
			var ampm = H < 12 ? "am" : "pm";
			timeString = h + timeString.substr(2, 3) + " "+ampm;
		        artEvt = artEvt+events[i][3]+'  '+events[i][1]+"  "+events[i][2]+'&';
			artEvtDetails=artEvtDetails+events[i][5]+'  '+events[i][8]+'%';
//events.push(["",String(eMon),String(eDat),String(eYr),pTim,venue,pnam,Pdeta,art,pLatLong]);			
	 
	art_lst+="<tr align='center' ><td>"+events[i][2]+"/"+events[i][1]+"/"+events[i][3]+ "&nbsp;&nbsp;"+timeString+"<br>";
			
			
	art_lst+=events[i][5]+'<br>'+'<br>';
	 
	art_lst+=events[i][7]+'<hr size=2></td></tr>';
		 
		}
 
} 
 
	art_lst = art_lst.replace('undefined','');
	artEvt = artEvt.replace('undefined','');
	artEvtDetails = artEvtDetails.replace('undefined','');
	document.getElementById('xPort').innerHTML=art_lst +"<table>";
	
	
	
}		
//****************************************************************//
function init() {
    	document.addEventListener("deviceready", onDeviceReady, false);
	
}
var newUsr;
 
function onDeviceReady(){
	 window.plugins.spinnerDialog.show(null, "Loading Events... Please wait!");
	 document.getElementById("dl_btn").style.display="none";
	document.getElementById("dl_btn").style.visibility="false";
	//document.getElementById("defaultOpen").click();
	document.getElementById("defaultOpen").click();
	
 	//chkFavorite();
	
	
	checkConnection();
	document.addEventListener("backbutton", backButtonHandler, false);
	//document.addEventListener("backbutton", function (e) {
       // e.preventDefault(); 
		
	//navigator.notification.confirm("Do you want to exit MMF?", onConfirmExit, "Madras Music Fest", "Yes,No");    }, false );
}
	
 
function backButtonHandler(e)
   {
if( activePg==5)  
      {
        venueBack(); // Code to exit app
       //  navigator.app.backHistory(); 
	      
      }
	   else if( activePg==2)
	   {
	   categoryBack();
	   }
      else
      {
        // Code to navigate to the history action
	// window.localStorage.setItem('favShows',favAddStr);
      navigator.notification.confirm("Do you want to exit MMM?", onConfirmExit, "Madras Music & Miscellany", "Yes,No");   
      }
}
 
		
		function venueBack()
		{
		venueFilter();
		
		}
		
		function categoryBack()
		{
		category();
		
		}
		
function checkConnection() {
     var networkState = navigator.connection.type;
     if(navigator.connection.type == Connection.NONE) {        
        connSel='N';
	   //  alert(connSel);
	     
        window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, RgotFS, fail);
    }
   else
      {
	    connSel='Y';
	     // alert(connSel);
	      
	      if(usrauth=='y')
	      {
	         
	      }
	      else
	      {
	      ajaxFunction();
	 changedate('return');
	      }
	// ajaxFunction();
	 
      }
 
}
	
function RgotFS(fileSystem) {
	//alert(fileSystem.root.fullPath);
    //    window.rootFS = fileSystem.root;
        fileSystem.root.getFile("events.txt", null, RgotFileEntry, fail);
	
    }	
	

function gotFS(fileSystem) {
        fileSystem.root.getFile("events.txt", {create: true, exclusive: false}, gotFileEntry, fail);
}

function RgotFileEntry(fileEntry) {
        fileEntry.file(gotFile, fail);
    }

		
	
	
function gotFileEntry(fileEntry) {
        fileEntry.createWriter(WriteText, fail);
    }	

	
function gotFile(file){
      readDataUrl(file);
        readAsText(file);
    }



    function readDataUrl(file) {
        var reader = new FileReader();
        reader.onloadend = function(evt) {
            console.log("Read as data URL");
            console.log(evt.target.result);
        };
        reader.readAsDataURL(file);
    }
	
	function readAsText(file) {
        var reader = new FileReader();
        reader.onloadend = function(evt) {
            console.log("Read as text");
            console.log(evt.target.result);
	 //   alert(evt.target.result);
	    document.getElementById('rest1').value=evt.target.result;	
	   changedate('return');
	//	 ajaxFunction();
        };
        reader.readAsText(file);
  }	
	
 function WriteText(writer) {
      writer.onwriteend = function(evt){ // Fired when end write.
        console.log("End write text in file");

    };
writer.write(ajaxResponse);
}
	
    function fail(error) {
	//alert(fileSystem.root.fullPath);
      //  window.rootFS = fileSystem.root;
        alert('Failed to load events...');
    }
function failU(error) {
        alert('Failed to load file..');
    }	
	
function getDaysInMonth(m, y) {
    return m===2 ? y & 3 || !(y%25) && y & 15 ? 28 : 29 : 30 + (m+(m>>3)&1);
}	

	
	
	
function onConfirmExit(button) {
if(button==2){ //If User select a No, then return back;
       	return; }
else{
   if (navigator.app) {
     navigator.app.exitApp(); }
   else if (navigator.device) {
     navigator.device.exitApp(); } }	
}
	   

/* Preload images script */
var myimages=new Array()
function preloadimages(){
	for (i=0;i<preloadimages.arguments.length;i++){
		myimages[i]=new Image();
		myimages[i].src=preloadimages.arguments[i];
	}
	
}


/* The path of images to be preloaded inside parenthesis: (Extend 

list as desired.) */
preloadimages("images/PrevYrOff40x40.png","images/PrevMoOff40x40.png","images/NextYrOff40x40.png","images/NextMoOff40x40.png");

var thisDate = 1;							// Tracks current date being written in calendar
var wordMonth = new Array("January","February","March","April","May","June","July","August","September","October","November","December");
var today = new Date();							// Date object to store the current date
var todaysDay = today.getDay() + 1;					// Stores the current day number 1-7
var todaysDate = today.getDate();					// Stores the current numeric date within the month
var todaysMonth = today.getUTCMonth() + 1;				// Stores the current month 1-12
var todaysYear = today.getFullYear();					// Stores the current year
var monthNum = todaysMonth;						// Tracks the current month being displayed
var yearNum = todaysYear;						// Tracks the current year being displayed
var firstDate = new Date(String(monthNum)+"/1/"+String(yearNum));	// Object Storing the first day of the current month
var firstDay = firstDate.getUTCDay();					// Tracks the day number 1-7 of the first day of the current month
var lastDate = new Date(String(monthNum+1)+"/0/"+String(yearNum));	// Tracks the last date of the current month
var numbDays = 0;
var calendarString = "";
var eastermonth = 0;
var easterday = 0;
var flg=1;
function changedate(buttonpressed) {
	ajaxFunction();
	//alert('optsel'+optSel);	
	//buttonpressed='return';
 
	if (buttonpressed == "return") { 
		monthNum = todaysMonth;
		yearNum = todaysYear;
	} else if (buttonpressed == "prevyr") yearNum--;
	else if (buttonpressed == "nextyr") yearNum++;
	else if (buttonpressed == "prevmo") monthNum--;
	else if (buttonpressed == "nextmo") monthNum++;
	 
	if (monthNum == 0) {
		monthNum = 12;
		yearNum--;
	}
	else if (monthNum == 13) {
		monthNum = 1;
		yearNum++
	}
	lastDate = new Date(String(monthNum+1)+"/0/"+String(yearNum));
	numbDays = lastDate.getDate();
	   
	if(isNaN(parseFloat("numbDays")))
	  {
	  numbDays = getDaysInMonth(monthNum, yearNum);
	  }
	  else
	  {
	   lastDate = new Date(String(monthNum+1)+"/0/"+String(yearNum));
	   numbDays = lastDate.getDate();
	  }
	  
	firstDate = new Date(String(monthNum)+"/1/"+String(yearNum));
	firstDay = firstDate.getDay() + 1;
	
	
	createCalendar();
	return;
	
		
}
function easter(year) {
// feed in the year it returns the month and day of Easter using two GLOBAL variables: eastermonth and easterday
var a = year % 19;
var b = Math.floor(year/100);
var c = year % 100;
var d = Math.floor(b/4);
var e = b % 4;
var f = Math.floor((b+8) / 25);
var g = Math.floor((b-f+1) / 3);
var h = (19*a + b - d - g + 15) % 30;
var i = Math.floor(c/4);
var j = c % 4;
var k = (32 + 2*e + 2*i - h - j) % 7;
var m = Math.floor((a + 11*h + 22*k) / 451);
var month = Math.floor((h + k - 7*m + 114) / 31);
var day = ((h + k - 7*m +114) % 31) + 1;
eastermonth = month;
easterday = day;
}
function createCalendar() {
	//window.plugins.spinnerDialog.hide();	
	
	
	
	
	calendarString = '';
	var daycounter = 0;
	calendarString += '<table width="312" border="1" cellpadding="0" cellspacing="1">';
	calendarString += '<tr>';
	calendarString += '<td align=\"center\" valign=\"center\" width=\"40\" height=\"40\"><a href=\"#\" onClick=\"changedate(\'prevyr\')\"><img name=\"PrevYr\" src=\"images\/PrevYrOff40x40\.png\" width=\"40\" height=\"40\" border=\"0\" alt=\"Prev Yr\"\/><\/a><\/td>';
	calendarString += '<td align=\"center\" valign=\"center\" width=\"40\" height=\"40\"><a href=\"#\" onClick=\"changedate(\'prevmo\')\"><img name=\"PrevMo\" src=\"images\/PrevMoOff40x40\.png\" width=\"40\" height=\"40\" border=\"0\" alt=\"Prev Mo\"\/><\/a><\/td>';
	calendarString += '<td bgcolor=\"#C8C896\" align=\"center\" valign=\"center\" width=\"128\" height=\"40\" colspan=\"3\"><b>' + wordMonth[monthNum-1] + '&nbsp;&nbsp;' + yearNum + '<\/b><\/td>';
	calendarString += '<td align=\"center\" valign=\"center\" width=\"40\" height=\"40\"><a href=\"#\" onClick=\"changedate(\'nextmo\')\"><img name=\"NextMo\" src=\"images\/NextMoOff40x40\.png\" width=\"40\" height=\"40\" border=\"0\" alt=\"Next Mo\"\/><\/a><\/td>';
	calendarString += '<td align=\"center\" valign=\"center\" width=\"40\" height=\"40\"><a href=\"#\" onClick=\"changedate(\'nextyr\')\"><img name=\"NextYr\" src=\"images\/NextYrOff40x40\.png\" width=\"40\" height=\"40\" border=\"0\" alt=\"Next Yr\"\/><\/a><\/td>';
	calendarString += '<\/tr>';
	calendarString += '<tr>';
	calendarString += '<td bgcolor=\"#DDDDDD\" align=\"center\" valign=\"center\" width=\"40\" height=\"22\">Sun<\/td>';
	calendarString += '<td bgcolor=\"#DDDDDD\" align=\"center\" valign=\"center\" width=\"40\" height=\"22\">Mon<\/td>';
	calendarString += '<td bgcolor=\"#DDDDDD\" align=\"center\" valign=\"center\" width=\"40\" height=\"22\">Tue<\/td>';
	calendarString += '<td bgcolor=\"#DDDDDD\" align=\"center\" valign=\"center\" width=\"40\" height=\"22\">Wed<\/td>';
	calendarString += '<td bgcolor=\"#DDDDDD\" align=\"center\" valign=\"center\" width=\"40\" height=\"22\">Thu<\/td>';
	calendarString += '<td bgcolor=\"#DDDDDD\" align=\"center\" valign=\"center\" width=\"40\" height=\"22\">Fri<\/td>';
	calendarString += '<td bgcolor=\"#DDDDDD\" align=\"center\" valign=\"center\" width=\"40\" height=\"22\">Sat<\/td>';
	calendarString += '<\/tr>';
	thisDate == 1;
	for (var i = 1; i <= 6; i++) {
		calendarString += '<tr>';
		for (var x = 1; x <= 7; x++) {
			daycounter = (thisDate - firstDay)+1;
			thisDate++;
			if ((daycounter > numbDays) || (daycounter < 1)) {
				calendarString += '<td align=\"center\" bgcolor=\"#888888\" height=\"30\" width=\"40\">&nbsp;<\/td>';
			} else {
				if (checkevents(daycounter,monthNum,yearNum,i,x) || ((todaysDay == x) && (todaysDate == daycounter) && (todaysMonth == monthNum))){
					if ((todaysDay == x) && (todaysDate == daycounter) && (todaysMonth == monthNum)) {
						calendarString += '<td align=\"center\" bgcolor=\"#81ab4b\" height=\"30\" width=\"40\"><a href=\"javascript:showevents(' + daycounter + ',' + monthNum + ',' + yearNum + ',' + i + ',' + x + ')\">' + daycounter + '<\/a><\/td>';
					}
 					else	calendarString += '<td align=\"center\" bgcolor=\"#FFFFC8\" height=\"30\" width=\"40\"><a href=\"javascript:showevents(' + daycounter + ',' + monthNum + ',' + yearNum + ',' + i + ',' + x + ')\">' + daycounter + '<\/a><\/td>';
				} else {
					calendarString += '<td align=\"center\" bgcolor=\"#ce9452\" height=\"30\" width=\"40\">' + daycounter + '<\/td>';
				}
			}
		}
		calendarString += '<\/tr>';
	}
	var object=document.getElementById('calendar');
	object.innerHTML= calendarString;
	thisDate = 1;
	
}
function checkevents(day,month,year,week,dayofweek) {

var numevents = 0;
var floater = 0;
	for (var i = 0; i < events.length; i++) {
		if (events[i][0] == "W") {
			if ((events[i][2] == dayofweek)) numevents++;
		}
		else if (events[i][0] == "Y") {
			if ((events[i][2] == day) && (events[i][1] == month)) numevents++;
		}
		else if (events[i][0] == "F") {
			if ((events[i][1] == 3) && (events[i][2] == 0) && (events[i][3] == 0) ) {
				easter(year);
				if (easterday == day && eastermonth == month) numevents++;
			} else {
				floater = floatingholiday(year,events[i][1],events[i][2],events[i][3]);
				if ((month == 5) && (events[i][1] == 5) && (events[i][2] == 4) && (events[i][3] == 2)) {
					if ((floater + 7 <= 31) && (day == floater + 7)) {
						numevents++;
					} else if ((floater + 7 > 31) && (day == floater)) numevents++;
				} else if ((events[i][1] == month) && (floater == day)) numevents++;
			}
		}
		else if ((events[i][2] == day) && (events[i][1] == month) && (events[i][3] == year)) {
			numevents++;
		}
	}
	if (numevents == 0) {
		return false;
	} else {
		return true;
	}
	
}
function showevents(day,month,year,week,dayofweek) {
	
	document.getElementById("det").style.display="block";
	document.getElementById("det").style.visibility="true";
	document.getElementById("xPort").style.display="block";
	document.getElementById("xPort").style.visibility="true";
	document.getElementById("dl_btn").style.display="block";
	document.getElementById("dl_btn").style.visibility="true";
	document.getElementById("csv").style.display="none";
	document.getElementById("csv").style.visibility="false"; 
	 
//	window.plugins.spinnerDialog.hide();		
var theevent = "";
var floater = 0;
		var kkkk=0;
	var favS= window.localStorage.getItem("favShows");
	document.getElementById('xPort').innerHTML='' ;
	//document.getElementById("xPort").innerHTML='';
	 
		
	for (var i = 0; i < events.length; i++) {
	
	if ((events[i][2] == day) && (events[i][1] == month) && (events[i][3] == year)) {
			
			hours=String(events[i][4]);
		 	
			 	
			var timeString = hours;
			var H = timeString.substr(0, 2);
			var h = H % 12 || 12;
	 
			var ampm = H < 12 ? "am" : "pm";
			timeString = h + timeString.substr(2, 3);


			 var chkStr = hours.substring( hours.indexOf(':') + 1 ) ;

				if(chkStr =='00')
			{

				jj=h + " "+ampm;
			}
			else
			{
				jj=timeString + " "+ampm;

			}
			

    

	 
			dayStr=stringToDate(events[i][2]+"/"+events[i][1]+"/"+events[i][3],"dd/MM/yyyy","/");
            var n = weekday[dayStr.getDay()];
			var mNam= monthNames[dayStr.getMonth()];
			
			
			
			 var chkStr = hours.substring( hours.indexOf(':') + 1 ) ;

				if(chkStr =='00')
			{

				jj=h + " "+ampm;
			}
			else
			{
				jj=timeString + " "+ampm;

			}
			aName=events[i][7].replace(/\s/g, "_");
		eName=events[i][8].replace(/\s/g, "_");
		
		
		
		chkValue1=stringIsEmpty(favS);
		
		if(chkValue1 ==true )
			
		{
		clsName='chartme-btn-main';
			
		}
	 
		else  
		{
		
			if(favS.indexOf(aName) !== -1)
		   {
		   clsName='arrowdown';
		   
		   }
			else
			{
			clsName='chartme-btn-main';
			}
		}	
		 
		while(kkkk<1)
		{
		theevent+="<br><table class=ven1><tr height='40px'><td colspan=3><center><b>"+n+", " +events[i][2]+" "+mNam+" "+events[i][3]+"</b></center></td></tr>";
			kkkk++;
		}
		
		 
//	<tr><td rowspan=3>rowspan</td><td >row1 col2</td><td  rowspan=3><img src='fav.png'></td></tr>
//<tr><td>row 2 col2</td> </tr>
 // <tr><td>row 2 col2</td> </tr>	
theevent+="<tr ><td rowspan=3>"+events[i][5]+" at "+jj+"</td><td >"+events[i][6]+" - <b>"+events[i][8]+"</b></td><td  rowspan=3 width='10px'>"+"<button id='favID'  class="+clsName +"  onclick= 'favAddShows11(this.value,this)'; value="+eName+'^'+aName+"!"+"> </button></td></tr>";	theevent+="<tr><td>"+events[i][7]+"</td> </tr>";
		theevent+="<tr><td>&nbsp;</font></td> </tr>";
		 
	
		//theevent+="<div id='wrapper' style='background:white'><div id='left' style='background:white;padding-left:8px;'>"+events[i][5]+" at "+jj+"<br></div><div id='right' style='background:white;'>"+events[i][6]+" - <b>"+events[i][8]+"</b><br><br>"+events[i][7]+	"<br><br></div></div> "	; 	
	 
 
		
		
		
		}
		//document.getElementById('dl_btn1').innerHTML=theevent;
	}
	if (theevent == "") 
	{
		document.getElementById("dl_btn").style.display="none";
	document.getElementById("dl_btn").style.visibility="false";
		theevent= 'No events to show...';
	    //    document.forms.eventform.eventlist.value = 'No events to show.';
		
	}
	 document.getElementById('dl_btn1').innerHTML=theevent;
	 document.getElementById('xPort').innerHTML=theevent+"</table>";
	 
}
	
function floatingholiday(targetyr,targetmo,cardinaloccurrence,targetday) {
var firstdate = new Date(String(targetmo)+"/1/"+String(targetyr));	// Object Storing the first day of the current month.
var firstday = firstdate.getUTCDay();	// The first day (0-6) of the target month.
var dayofmonth = 0;	// zero out our calendar day variable.
	targetday = targetday - 1;
	if (targetday >= firstday) {
		cardinaloccurrence--;	// Subtract 1 from cardinal day.
		dayofmonth = (cardinaloccurrence * 7) + ((targetday - firstday)+1);
	} else {
		dayofmonth = (cardinaloccurrence * 7) + ((targetday - firstday)+1);
	}
return dayofmonth;
}
var ajaxResponse;
var arr_store;
  function ajaxFunction()
{

	if(connSel=='Y')
	{	
	var xhr = new XMLHttpRequest();
	xhr.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
       // Typical action to be performed when the document is ready:
       
	   document.getElementById('rest1').value=xhr.responseText;
	ajaxResponse=xhr.responseText;
	window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, gotFS, fail);
	  //  window.plugins.spinnerDialog.hide();
	procVal(ajaxResponse);
    }
	else
	{
	//alert('Network error...Failed to load events. Try again..');
	}
	 
};
xhr.open("GET", 'http://www.writeacademy.in/MMF/test.php', true);
xhr.send();


	}
	else
	{
	//	alert('no conn');
	//	alert(document.getElementById('rest1').value);
		 
	procVal(document.getElementById('rest1').value);
	}
	
	 
}
function alertDismissed1()
	{
//	navigator.device.exitApp();
		//navigator.app.exitApp();
}
	
		
var latR;
var events = new Array();
var venue_arr = new Array();
	
function procVal(pVar)
{
//multiArr=[];
	 if (pVar!='')
	 {
	  window.plugins.spinnerDialog.hide();
	 }
	//alert('Ajax Resp'+pVar);
	locArr = pVar;
	//document.getElementById('rest1').value=pVar;
	document.getElementById('rest1').value=locArr;
	locArr = locArr.substring(0, locArr.length-1 );
	locArr=locArr.split('#');
	events=[];
	venue_arr=[];
	artistArr=new Array();
	for (var i = 0; i<locArr.length; i++) {
		delimiter = ',';
		start = 6;
		var result = locArr[i].split(delimiter, start+1).join(delimiter);
		//document.getElementById('rest1').value=result;
		latR=result.split(',');
		document.getElementById('rest1').value+=result;
		//multiArr.push([latR[0],latR[1],latR[2],latR[3],latR[4],latR[5]]);
		pnam=String(latR[0]);
		venue=String(latR[1]);
		venue=venue.replace(/\s/g, ' ');
		art=String(latR[2]);
		Pdeta=String(latR[3]);
		Pdeta=Pdeta.replace('^','\'');
		pTim=String(latR[5]);
		pLatLong=String(latR[6]);
		var dt = new Date(latR[4]);
		var eDat= dt.getDate();
		eMon=dt.getMonth()+1;
		eYr=dt.getFullYear();
		//multiArr.push([latR[2],latR[0],latR[1],dist]);
		events.push(["",String(eMon),String(eDat),String(eYr),pTim,venue,pnam,Pdeta,art,pLatLong]);
		venue_arr.push([venue]);
		artistArr.push(art);
		//alert(events.length);
		//write ajax response to text file
		
		//break;
		}
	
	//testing();
	uniq = remove_duplicates_safe(venue_arr);
//	uniq = uniq.map(function(e) {  var result = {};    result['text'] =e[0];  result['value'] =e[0];   return result;});
 //alert(events);
}
	



	function venueFilter()
	{
		active_page=1;
		activePg=1;
		var j;
		//checkConnection();
		// $("#lst_mnu").slideToggle("slow");
			//  $('#lst_mnu').toggle('slide','right',500);
		 
		$('#lst_mnu').show('slide', 400);
		//document.getElementById("lst_mnu").style.display="block";
		//document.getElementById("lst_mnu").style.visibility="true";
		 
		 
		
		document.getElementById("calendar").style.display="none";
		document.getElementById("calendar").style.visibility="false";
		document.getElementById("category").style.display="none";
		document.getElementById("category").style.visibility="false";
		document.getElementById("det").style.display="none";
		document.getElementById("det").style.visibility="false";
		document.getElementById("map").style.display="none";
		document.getElementById("map").style.visibility="false";
		document.getElementById("xPort1").style.display="none";
		document.getElementById("xPort1").style.visibility="false";
		
		
		
		document.getElementById("xPort").style.display="none";
		document.getElementById("xPort").style.visibility="false";
		
		document.getElementById("dl_btn").style.display="none";
		document.getElementById("dl_btn").style.visibility="false";
		document.getElementById("dl_btn1").style.display="none";
		document.getElementById("dl_btn1").style.visibility="false";
		//alert('in');
		
        if(uniq.length % 2==0)
{
 
}
else
{
uniq.push(["d"]);
 
}
		//var im_htm='';
var im_htm="<table border='0'  class='ven' cellpadding='0' cellspacing='0'>";
	 
	for (var i = 0, len = uniq.length; i < len; i++) {
	
	j=i+1;
		
	
		ch_uni=String(uniq[i]);
		 
		ch_uni=ch_uni.replace(/\s/g, '_');
		 
              ch_uni1=String(uniq[j]);
		ch_uni1=ch_uni1.replace(/\s/g, '_');

 
if(uniq[j]=='d')
{
	 
	im_htm+="<tr height='120px'> <td style='width: 50%; height: 50px; border: 0px solid gray;'><button onclick='ven_det(this.value);' class='btn24' value="+ch_uni +">"+uniq[i]+"</button></td><td>&nbsp;</td> </tr>";
 }
		else
		{
 
			
im_htm+="<tr height='120px'> <td style='width: 50%; height: 50px; border: 0px solid gray;'><button onclick='ven_det(this.value);' class='btn24' value="+ch_uni +">"+uniq[i]+"</button></td> <td style='width: 50%; height: 50px; border: 0px solid gray;'><button onclick='ven_det(this.value);' class='btn24' value="+ch_uni1+">"+uniq[j]+"</button></td> </tr>";
}
	 i=j;
	
	}
	
document.getElementById('lst_mnu').innerHTML=im_htm+"</table>" ;
	
}

function login()
{
//alert('in');
 activePg=2;
	//alert('in loop');
	document.getElementById("backmenu").style.display="block";
	document.getElementById("backmenu").style.visibility="true";
	document.getElementById("main").style.visibility="false";
	document.getElementById("main").style.display="none";
	document.getElementById("mainMenu").style.visibility="false";
	document.getElementById("mainMenu").style.display="none";
	document.getElementById("map").style.display="none";
document.getElementById("map").style.visibility="false";
document.getElementById("calendar").style.display="none";
document.getElementById("calendar").style.visibility="false"; 
document.getElementById("login").style.visibility="true";
document.getElementById("login").style.display="block";
document.getElementById("archive").style.visibility="false";
document.getElementById("archive").style.display="none";
	
document.getElementById("det").style.display="none";
document.getElementById("det").style.visibility="false";
document.getElementById("lst_mnu").style.display="none";
document.getElementById("lst_mnu").style.visibility="false";
document.getElementById("dl_btn").style.display="none";
document.getElementById("dl_btn").style.visibility="false";
document.getElementById("dl_btn1").style.display="none";
document.getElementById("dl_btn1").style.visibility="false";
document.getElementById("category").style.display="none";
document.getElementById("category").style.visibility="false";
document.getElementById("xPort").style.display="none";
document.getElementById("xPort").style.visibility="false";
document.getElementById("xPort1").style.display="none";
document.getElementById("xPort1").style.visibility="false";
document.getElementById("tab").style.display="none";
document.getElementById("tab").style.visibility="false";
}
function backSt() 
	{
		backbtn=1;
		  activePg=2;
		
		 $('#category').show();
		 $('#main').show();
		 $('#mainMenu').show();
		 $('#searchmenu').hide();
		 $('#login').hide();
		 $('#backmenu').hide();
		 $('#xPort').hide();
		$('#dl_btn').hide();
		$('#archive').hide();
		$('#map').hide();
		//document.getElementById("login").style.visibility="false";
		//document.getElementById("login").style.display="none";
		//document.getElementById("category").style.display="block";
		//document.getElementById("category").style.visibility="true";
		//document.getElementById("main").style.display="block";
	//	document.getElementById("main").style.visibility="true";
	//	 document.getElementById("mainMenu").style.display="block";
	//	document.getElementById("mainMenu").style.visibility="true"; 
	//	document.getElementById("backmenu").style.display="none";
	//	document.getElementById("backmenu").style.visibility="false";
	//	document.getElementById("defaultOpen").click();
}


function openCity(evt, cityName) {
    var i, tabcontent, tablinks;
	 activePg=1;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(cityName).style.display = "block";
    evt.currentTarget.className += " active";
	
	if(cityName=='London')
	{
	optSel=2;
	active_page=1;
	calClick();
	}
	else if(cityName=='Paris')
	{
	optSel=3;
	active_page=1;
	venueFilter();
	}
	else if(cityName=='Tokyo')
	{
	optSel=1;
	active_page=1;
	 
	category();
	}
}	

function category()
{
	  
 
		$('#category').show('slide', 400);
		$('#xPort').hide();
	  activePg=1;
		document.getElementById("xPort").style.visibility="false";
		//document.getElementById("category").style.display="block";
		//document.getElementById("category").style.visibility="true";
		document.getElementById("login").style.display="none";
		document.getElementById("login").style.visibility="false"; 
		
		document.getElementById("mainMenu").style.display="block";
		document.getElementById("mainMenu").style.visibility="true"; 
		document.getElementById("main").style.display="block";
		document.getElementById("main").style.visibility="true";
		// $('#searchmenu').hide();
		$("#searchmenu").css("display","none");
		document.getElementById("map").style.display="none";
		document.getElementById("map").style.visibility="false";
		
		document.getElementById("backmenu").style.display="none";
		document.getElementById("backmenu").style.visibility="false";
		
		document.getElementById("dl_btn1").style.display="none";
		document.getElementById("dl_btn1").style.visibility="false";
		document.getElementById("dl_btn").style.display="none";
		document.getElementById("dl_btn").style.visibility="false";
		document.getElementById("calendar").style.display="none";
		document.getElementById("calendar").style.visibility="false";
		document.getElementById("lst_mnu").style.display="none";
		document.getElementById("lst_mnu").style.visibility="false";
		
		document.getElementById("xPort1").style.display="none";
		document.getElementById("archive").style.visibility="false";
		document.getElementById("archive").style.display="none";
		document.getElementById("xPort1").style.visibility="false";
		document.getElementById("rnd").style.display="none";
		document.getElementById("rnd").style.visibility="false";
		document.getElementById("det").style.display="block";
		document.getElementById("det").style.visibility="true";
		
		document.getElementById("route_canvas").style.display="none";
		document.getElementById("route_canvas").style.visibility="false"
		document.getElementById("panel").style.display="none";
		document.getElementById("panel").style.visibility="false";
		 
	 
		 
		
}
function storeLocal(un,pd) {
//    window.localStorage.setItem('key', un);
	 
  window.localStorage.setItem('key', un);
//alert(un);
 // window.localStorage.setItem("key", 'siva');
//cordova.plugins.SecureLocalStorage.setItem("key" , un);
	//window.localStorage.key = un;
  //  window.localStorage.setItem('pw', pd);
//window.localStorage["key"] =un;
//window.localStorage["pw"] = pd;
	//alert(window.localStorage.getItem('pw'));
}
 
		
 	
		
function check() {

    // stored data from the register-form
     var storedName = window.localStorage.getItem("key");
//   var storedName =cordova.plugins.SecureLocalStorage.getItem("key")
//alert('s'+storedName);
	 
      // check if stored data from register-form is equal to data from login form
    if(storedName == null   ) {
         $('nav[role="main"]').slideAndSwipe();
    }else {
           $('nav[role="sub"]').slideAndSwipe();
    }
	 
}		
 function ajaxCall(n)   {
	 var msg1;
	 opt1=n;
	 x=document.getElementById('usrname').value;
	 y=document.getElementById('usrpwd').value;
	 
	 if(x!='' && y!='')
	 {
	x=x.replace(/^\s\s*/, '').replace(/\s\s*$/, '');

	 if( !validateEmail(x)) 
	 {
	 var msg2='Invalid Email ID/Password';
	 navigator.notification.alert(  msg2,   alertDismissed,  'Login',   'Done'  );
      
	 }
	 else
	 {
	 //	 store(x,y);
	
	 var params = "unam=" + x +"&pwd=" + y+"&optionBtn=" + opt1; 
	 var xhttp = new XMLHttpRequest();
	xhttp.onreadystatechange = function() {
 
    if (this.readyState == 4) {
	 //   alert(this.status);
      if(this.status == 200 || this.status == 0){
   	//	alert(this.responseText);
	      if(this.responseText.charAt(0)=='1')
	      {
		      window.localStorage.setItem("key", x);
		      check();
	      }
	      
	      msg1=this.responseText.slice(1);
	       navigator.notification.alert(msg1,   alertDismissed,  'Login',   'OK'  );
	     
    }
    };
  }
  xhttp.open("POST", "http://www.writeacademy.in/MMF/userCheck.php", true);
  xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
  xhttp.send(params);
	 }	
	 
	 
}	 
	 else
	 {
	//	 alert('wrong');
	 navigator.notification.alert(  'Invalid Email ID/Password',   alertDismissed,  'Login',   'OK'  );
	 }
	setTimeout(function(){  }, 29000);
	document.getElementById("defaultOpen").click();



}

	function ajaxCallFn(e_mail)   {
	 var msg1;
	 opt1=n;
		 
	   e_mail=e_mail.replace(/^\s\s*/, '').replace(/\s\s*$/, '');

	//alert(e_mail);
	
	 var params = "usrMail=" + e_mail; 
	 var xhttp = new XMLHttpRequest();
	xhttp.onreadystatechange = function() {
 
    if (this.readyState == 4) {
	 //   alert(this.status);
      if(this.status == 200 || this.status == 0){
    	//alert(this.responseText);
	      	     
	       navigator.notification.alert(this.responseText,   alertDismissed,  'Forgot Password',   'OK'  );
	     
    }
    };
	}
  xhttp.open("POST", "http://www.writeacademy.in/MMF/forgot_pass-mmf.php", true);
  xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
  xhttp.send(params);
		
	 
	setTimeout(function(){  }, 19000);
	document.getElementById("defaultOpen").click();

}	 
	 



function validateEmail($email) {
  var emailReg = /^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;
  return emailReg.test( $email );
}	
function forgot_pass()
	
	{
//	alert('in'); 
		 activePg=2;
	navigator.notification.prompt('Enter mail ID', onPrompt,   'Forgot Password',   ['Ok']     );
		//  ajaxCallFn(mailForgot); 
}
	var mailForgot; 
function onPrompt(results) {
  //alert( results.input1);
	if(results.input1!='')
	{
	var emailID=results.input1.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
	//	 mailForgot=emailID;
	 if( !validateEmail(emailID)) 
	 { 
	 var msg2='Invalid Email ID';
	 navigator.notification.alert(  msg2,   alertDismissed,  'Forgot Password',   'OK'  );
      
	 }
	else
	{
		//alert('in'+emailID); 
	// var url1 = "http://www.writeacademy.in/MMF/forgot_pass-mmf.php"; 
		
		var params = "usrMail=" + emailID; 
	 var xhttp = new XMLHttpRequest();
	xhttp.onreadystatechange = function() {
 
    if (this.readyState == 4) {
	 //   alert(this.status);
      if(this.status == 200 || this.status == 0){
    	//alert(this.responseText);
	      	     
	       navigator.notification.alert(this.responseText,   alertDismissed,  'Forgot Password',   'OK'  );
	     
    }
    };
	}
  xhttp.open("POST", "http://www.writeacademy.in/MMF/forgot_pass-mmf.php", true);
  xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
  xhttp.send(params);
		
	 
	setTimeout(function(){  }, 19000);
	document.getElementById("defaultOpen").click();
		
	

		
	}
      
	}
	else
	{
	var msg2='Invalid Email ID';
	 navigator.notification.alert(  msg2,   alertDismissed,  'Forgot Password',   'OK'  );
      
	 }
}	
		
var file_upload='xport1.csv';	
	
	
function archive()
{
	var config = {
    title: "Select a Month", 
    items: [
        { text: "January", value: "1" },
        { text: "February", value: "2" },
        { text: "March", value: "3" },
        { text: "April", value: "4" },
        { text: "May", value: "5" },
        { text: "June", value: "6" },  
	{ text: "July", value: "7" },
	{ text: "August", value: "8" },
        { text: "September", value: "9" },
        { text: "October", value: "10" },
        { text: "November", value: "11" },
        { text: "December", value: "12" } 
        
    ],
    selectedValue: "July",
    doneButtonLabel: "Done",
    cancelButtonLabel: "Cancel"
};	
 activePg=2;
// Show the picker
window.plugins.listpicker.showPicker(config, 
    function(item) { 
   //   alert("You have selected " + item.text);
	selMonth= item;
	var url1 = "http://www.writeacademy.in/MMF/archiveTest.php"; 
	doRequest(url1,selMonth);
 
    },
    function() { 
      //  alert("You have cancelled");
    }
);
}

function doRequest(url,monSel) {
	//alert(monSel);
	var params = "arcMon=" + monSel; 
	var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
 
    if (this.readyState == 4) {
	 
      if(this.status == 200 || this.status == 0){
  
    document.getElementById('rest2').value= this.responseText;
	     
	      if(this.responseText.length!=0)
		 {
		//  document.getElementById("archive").innerHTML = this.responseText;
	    procValArc(document.getElementById('rest2').value); 
		 }
	        else {
    		 navigator.notification.alert( 'No archive found..!',   alertDismissed,  'Archive',   'OK'  );
    		}
	      
    }
	     
    }
  };
  xhttp.open("POST", url, true);
  xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
  xhttp.send(params);
}


function alertDismissed() {
            alert('Invalid');
        }	

 

	
function calClick()
	{
		//alert('optsel'+optSel);
		optSel=2;
		 activePg=1;
		active_page=1; 
		document.getElementById("archive").style.display="none";
		document.getElementById("archive").style.visibility="false"; 
		$('#calendar').show('slide', 400);
		// $("#calendar").slideToggle("slow");
		//	  $('#calendar').toggle('slide','right',500);	 
		//document.getElementById("calendar").style.display="block";
		//document.getElementById("calendar").style.visibility="true";
		document.getElementById("category").style.display="none";
		document.getElementById("category").style.visibility="false";
		document.getElementById("login").style.display="none";
		document.getElementById("login").style.visibility="false";
		document.getElementById("xPort").style.display="none";
		document.getElementById("xPort").style.visibility="false";
		document.getElementById("map").style.display="none";
		document.getElementById("map").style.visibility="false";
		document.getElementById("xPort1").style.display="none";
		document.getElementById("xPort1").style.visibility="false";
		document.getElementById("lst_mnu").style.display="none";
		document.getElementById("lst_mnu").style.visibility="false";
		document.getElementById("dl_btn").style.display="none";
		document.getElementById("dl_btn").style.visibility="false";
		document.getElementById("dl_btn1").style.display="none";
		document.getElementById("dl_btn1").style.visibility="false";
		document.getElementById("route_canvas").style.display="none";
		document.getElementById("route_canvas").style.visibility="false"
		document.getElementById("panel").style.display="none";
		document.getElementById("panel").style.visibility="false";
		document.getElementById("archive").style.visibility="false";
		document.getElementById("archive").style.display="none";
	
		checkConnection();
}

		
chkFav=[];
chkNotFav=[];
var table_string;
function stringIsEmpty(value) {
//	alert(value);
    if( typeof(value) === 'undefined' || value === null ){
	    
    return true;
}
    else 
    {
        return false;
    
    }

}

		
		
function ven_det(v)
{
 
	k=0;
	 
	 activePg=5;
	
	v=v.replace(/_/g, " ");
	 
	
	 
	
	var favS= window.localStorage.getItem("favShows");
	//var NotfavS= window.localStorage.getItem("NotfavShows");
	
	
	active_page=2;
	document.getElementById("xPort").style.display="block";
	document.getElementById("xPort").style.visibility="true";
	document.getElementById("map").style.display="block";
	document.getElementById("map").style.visibility="true";
	document.getElementById("xPort1").style.display="block";
	document.getElementById("xPort1").style.visibility="true";
	document.getElementById("archive").style.display="none";
	document.getElementById("archive").style.visibility="false";
	document.getElementById("lst_mnu").style.display="none";
	document.getElementById("lst_mnu").style.visibility="false";
	document.getElementById("dl_btn").style.display="block";
	document.getElementById("dl_btn").style.visibility="true";
	
	document.getElementById('xPort').innerHTML='' ;
	
	calEvt ='';
	calEvtDetails='';
	var ev_lst="<table border='0' id='test' class='ven1' cellpadding='0' cellspacing='0'>";
	//events.push(["",String(eMon),String(eDat),String(eYr),pTim,venue,pnam,Pdeta,art,pLatLong]);	
	for (var i = 0, len = events.length; i < len; i++)
 {
	if(events[i][5]==v)
	{
		 
		if(k==0)
		{
			 
			ev_lst+="<tr height='50px'><td colspan=3 align='center'><font size=3 face=arial>"+v+"</font></td></tr> ";
		}
		k++;
		hours=String(events[i][4]);
			var timeString = hours;
			var H = +timeString.substr(0, 2);
			var h = H % 12 || 12;
			var ampm = H < 12 ? "am" : "pm";
			timeString = h + timeString.substr(2, 3);
		calEvt = calEvt+events[i][3]+'  '+events[i][1]+"  "+events[i][2]+'&';
			calEvtDetails=calEvtDetails+events[i][5]+'  '+events[i][8]+'%';
		storeDate=events[i][2]+"/"+events[i][1]+"/"+events[i][3];
		dayStr=stringToDate(events[i][2]+"/"+events[i][1]+"/"+events[i][3],"dd/MM/yyyy","/");
	                var n = weekday[dayStr.getDay()];
			var mNam= monthNames[dayStr.getMonth()];
			
		//	events.push(["",String(eMon),String(eDat),String(eYr),pTim,venue,pnam,Pdeta,art,pLatLong]);	
			
			 var chkStr = hours.substring( hours.indexOf(':') + 1 ) ;

				if(chkStr =='00')
			{

				jj=h + " "+ampm;
			}
			else
			{
				jj=timeString + " "+ampm;

			}
			
		
		aName=events[i][7].replace(/\s/g, "_");
		eName=events[i][8].replace(/\s/g, "_");
		
		
		
		chkValue1=stringIsEmpty(favS);
	//	chkValue2=stringIsEmpty(NotfavS);
 //	 if ( !favS ) {
  // some_variable is either null, undefined, 0, NaN, false, or an empty string
//}
//	if(favS ===null && NotfavS === null)
//	{
//			clsName='chartme-btn-main';
//	}
//	else if(typeof(favS)  ==='undefined' && typeof(NotfavS)  === 'undefined')
//	{
//	clsName='chartme-btn-main';
//	}
//	else if(typeof(NotfavS)  ==='undefined' && favS  === null)
//	{
//	clsName='chartme-btn-main';
//	}
//	else if(typeof(favS)  ==='undefined' && NotfavS  === null)
//	{
//	clsName='chartme-btn-main';
//	}
		
		 
 //alert(chkValue1);
//	 alert(chkValue2);	
	
		
		
		if(chkValue1 ==true )
			
		{
		clsName='chartme-btn-main';
			
		}
	 
		else  
		{
		
			if(favS.indexOf(aName) !== -1)
		   {
		   clsName='arrowdown';
		   
		   }
			else
			{
			clsName='chartme-btn-main';
			}
		}	
		 
		 
		
			
			
			
			
			
		
		 
//alert(favS+'-'+NotfavS+'-'+clsName);
  ev_lst+="<tr><td width='40%'>"+n+", " +events[i][2]+" "+mNam+"</td><td rowspan=2 width='59%'>"+events[i][6]+" - <b>"+events[i][8]+"</b>"+"<br> "+events[i][7]+"</td><td rowspan=2 width='10px'><button id='favID'  class="+clsName +"  onclick= 'favAddShows11(this.value,this)'; value="+eName+'^'+aName+"!"+"> </button></td></tr><tr><td>"+jj+"</td></tr> <tr><td colspan=3><hr></td></tr>"; 
		}
		
	 
		
	 
	 
	 calEvt = calEvt.replace('undefined','');
	calEvtDetails = calEvtDetails.replace('undefined','');
 document.getElementById('xPort').innerHTML=ev_lst+"</table>" ;
	
 
	v1=v.replace(/ /g, "+");
 
	 

}
		 getLoc();
	
	
width= window.innerWidth;	   // |//| document.body.clientWidth,
  height= window.innerHeight;	   //|| document.body.clientHeight
  
var img_url="http://maps.googleapis.com/maps/api/staticmap?center="
        +v1+",Chennai&zoom=17&size="+width+"x300&markers=color:blue%7Clabel:S%7C11211%7C11206%7C11222&sensor=false";
	
 
        document.getElementById("map").innerHTML="<img src='"+img_url+"'>";	 
 }
		
	var favAddStr;	
	
var favArr = [];
var NotfavArr = [];

		
		
		function favAddShows11(fav,el)
		{
		if($(el).hasClass("arrowdown"))
	{
	 $(el).addClass('chartme-btn-main').removeClass('arrowdown');
		var favHst=window.localStorage.getItem("favShows");
		// var pattern = /\bproprietary\b/ig;
   		favHst= favHst.replace(fav,"");
		window.localStorage.setItem('favShows',favHst);
		newfavS=window.localStorage.getItem("favShows");
		//alert('new'+newfavS);
	}	
			else
			{
			
			 $(el).addClass('arrowdown').removeClass('chartme-btn-main'); 
		
	  
		var favHst=window.localStorage.getItem("favShows");
			// 	alert('fav-before '+favHst);
				
				favArr.length = 0;
			//	alert('favarr'+favArr);
		if(favHst!='' || favHst!=null || typeof(favHst)!='undefined')
		{
		//	 alert('in');
			favArr.push(favHst);
		}
	
	    
 		favArr.push([fav]);
	      window.localStorage.setItem('favShows',favArr);
				var favUpd=window.localStorage.getItem("favShows");
				// alert('fav -after'+favUpd);
			}
		
		}
		
		
		
		
	
		
		 
function getLoc() 
{
	
    // nothing
 
	if (navigator.geolocation)
          {
            //navigator.geolocation.getCurrentPosition(myMap);
          }
        else
          {
                document.getElementById("map").innerHTML="Network error. Connect to internet...";
          }

} 
	
function printData()
{
   var divToPrint=document.getElementById("xPort");

   pdf.htmlToPDF({
            data: divToPrint.innerHTML,
            documentSize: "A4",
            landscape: "portrait",
            type: "share" //use share to open the open-with-menu. 
        }, this.success, this.failure);
}

	
	$(document).ready(function(){
		$("#exportpdf").on('click', function () {
                 printData();
			});
			
});	

var calEvt='';
var calEvtDetails='';
var calEvt1=[];
var calEvtDetails1=[];
	
	
function eventList(eVal)
{
//alert('eval'+eVal);
 activePg=2;
document.getElementById("xPort").style.display="block";
document.getElementById("xPort").style.visibility="true";
	document.getElementById("xPort1").style.display="block";
	document.getElementById("xPort1").style.visibility="true";
	
document.getElementById("lst_mnu").style.display="none";
document.getElementById("lst_mnu").style.visibility="false";
document.getElementById("dl_btn").style.display="block";
document.getElementById("dl_btn").style.visibility="true";
document.getElementById("category").style.display="none";
document.getElementById("category").style.visibility="false";
document.getElementById('xPort').innerHTML='' ;
var catSel;

if(eVal=='1' || eVal==1)
{
	catSel='Concert';
}else if(eVal=='2' || eVal==2)
{
	catSel='Dance';
}else if(eVal=='3' || eVal==3)
{
	catSel='Drama';
}else if(eVal=='4' || eVal==4)
{
catSel='Lec-dem';
}else if(eVal=='5' || eVal==5)
{
catSel='Harikatha';
}else if(eVal=='6' || eVal==6)
{
catSel='Meetup';
	//alert(catSel.length);
}
calEvt ='';
	calEvtDetails='';
//alert(catSel);
	var ev_lst='';
	var favS= window.localStorage.getItem("favShows");
//var ev_lst="<br><center><b>"+  catSel +"</center></b><br>";
	var ev_lst="<table border='0' id='test' class='ven1' cellpadding='0' cellspacing='0'>";
	ev_lst+="<tr height='50px'><td colspan=3 align='center'><font size=3 face=arial>"+catSel+"</font></td></tr> ";
	var heading1=ev_lst;
for (var i = 0, len = events.length; i < len; i++)
{
	cat1=events[i][6];
	if(catSel==cat1)
		{
			
			hours=String(events[i][4]);
			var timeString = hours;
			var H = +timeString.substr(0, 2);
			var h = H % 12 || 12;
			var ampm = H < 12 ? "am" : "pm";
			timeString = h + timeString.substr(2, 3)  ;
			calEvt = calEvt+events[i][3]+'  '+events[i][1]+"  "+events[i][2]+'&';
			calEvtDetails=calEvtDetails+events[i][5]+'  '+events[i][8]+'%';
			dayStr=stringToDate(events[i][2]+"/"+events[i][1]+"/"+events[i][3],"dd/MM/yyyy","/");
	                var n = weekday[dayStr.getDay()];
			var mNam= monthNames[dayStr.getMonth()];
			
			
			
			 var chkStr = hours.substring( hours.indexOf(':') + 1 ) ;

				if(chkStr =='00')
			{

				jj=h + " "+ampm;
			}
			else
			{
				jj=timeString + " "+ampm;

			}
			
		aName=events[i][7].replace(/\s/g, "_");
		eName=events[i][8].replace(/\s/g, "_");
		
		
		
		chkValue1=stringIsEmpty(favS);
			
		if(chkValue1 ==true )
			
		{
		clsName='chartme-btn-main';
			
		}
	 
		else  
		{
		
			if(favS.indexOf(aName) !== -1)
		   {
		   clsName='arrowdown';
		   
		   }
			else
			{
			clsName='chartme-btn-main';
			}
		}	
		 
			//alert(n);
			//var result = parseFloat(4.00);
		//	alert(hours);
//<tr><td rowspan=3>rowspan</td><td >row1 col2</td><td  rowspan=3><img src='fav.png'></td></tr>
//<tr><td>row 2 col2</td> </tr>
 // <tr><td>row 2 col2</td> </tr>
	  
	  
//	ev_lst+="<tr align='center' ><td>"+events[i][2]+"/"+events[i][1]+"/"+events[i][3]+ "&nbsp;&nbsp;"+timeString+"<br>";
//		ev_lst+="<tr align='center' ><td>"+n+", " +events[i][2]+" "+mNam+" "+timeString+"<br>";
			
//	ev_lst+=events[i][5]+'<br>'+'<br>';
//	ev_lst+=events[i][8]+'<br>';
//	ev_lst+=events[i][7]+'<hr size=2></td></tr>';
//ev_lst="<div id='wrapper'><div id='left'>"+events[i][5]+"</div><div id='right'>"+n+"," +events[i][2]+" "+mNam+" "+timeString+"<br>"+events[i][8]+"<br>"+events[i][7]+"</div>"
//</div> 
	 
		
ev_lst+="<tr><td rowspan=4>&nbsp;&nbsp;"+events[i][5]+"</td><td><b>"+n+", " +events[i][2]+" "+mNam+" "+' '+jj+"</b></td><td  rowspan=4 width='10px'><button id='favID'  class="+clsName +"  onclick= 'favAddShows11(this.value,this)'; value="+eName+'^'+aName+"!"+"> </button></td></tr>";
		
	ev_lst+="<tr><td>"+events[i][8]+"</td> </tr>";
	ev_lst+="<tr><td>"+events[i][7]+"</td> </tr>";
	ev_lst+="<tr height='8px'><td>&nbsp;</td> </tr>";
//	ev_lst+="<div id='wrapper'><div id='left'>"+events[i][5]+"</div><div id='right'><b>" +n+", " +events[i][2]+" "+mNam+" "+' '+jj+'</b><br><font color=#6a737d>'+'<br>'+events[i][8]+'<br><br>'+events[i][7]+"</font><br><br></div></div> "	;		
	 
	 
			
		}
 
} 
 
	ev_lst = ev_lst.replace('undefined','');
	calEvt = calEvt.replace('undefined','');
	calEvtDetails = calEvtDetails.replace('undefined','');
	if(heading1==ev_lst)
	{
		ev_lst=heading1+'<tr><td>No events to show ...</td><tr>';
	}
	document.getElementById('xPort').innerHTML=ev_lst+"</table>";
	 
 
}
	
function calAdd()
	
{
	
	calEvt1=calEvt.split('&');
	 calEvtDetails1=calEvtDetails.split('%');
	 
	 
	for (var i = 0; i <calEvt1.length-1; i++) {
	//	alert(calEvt1[i]);
	// Start date and time of the event
  var startDate = new Date(calEvt1[i]);
  // End date and time of the event 
  var endDate = new Date(calEvt1[i]);
  // Title of the event 
  var title = "Madras Music Miscellany";
  // Location of the event 
  var location = "Chennai";
  // Description about the event 
  var notes = calEvtDetails1[i];
   var calsuccess = function(message) { navigator.notification.alert('Scehdule added Successfully...',  alertDismissed,   'Madras Music & Miscellany',   'OK');};
  var calerror = function(message) { alert("Error: " + message); };
// window.plugins.calendar.createEvent(title,location,notes,startDate,endDate,calsuccess,calerror);
		window.plugins.calendar.createEventInteractively(title,location,notes,startDate,endDate,calsuccess,calerror);
	}
  
 
   
	 
}	
function fav()
	{
	
var favItm= $("#xPort").html();
	var regex = /(<([^>]+)>)/ig;
	 favItm = favItm.replace(regex, " ");

   favItm = favItm.replace(/&nbsp;/g,'');
		
	}
	
function share()
{
	//printData();
	//var shareCont=document.getElementById('xPort').innerHTML;
	var message= $("#xPort").html();
	var regex = /(<([^>]+)>)/ig;
	  message = message.replace(regex, " ");

   message = message.replace(/&nbsp;/g,'');
	
	
//	window.plugins.socialsharing.share('MMM','Madras Music & Miscellany','Testing',null);
//setTimeout(function(){ navigator.notification.alert('Image Shared Successfully...',  alertDismissed,   'DigiGraph',   'OK'); },8000);
//window.plugins.socialsharing.share('Optional message',  'Optional title','default.pdf',null);	
window.plugins.socialsharing.share(message); 
}
	
function onSuccess()
{
navigator.notification.alert('Scehdule Shared Successfully...',  alertDismissed,   'Madras Music & Miscellany',   'OK');	
}
function onError()
{
	
navigator.notification.alert('Share Failed...',  alertDismissed,   'Madras Music & Miscellany',   'OK');	
}	
function alertDismissed() {
            // do
			}	

function procValArc(pVar)
{
//multiArr=[];
	//alert('Ajax Resp'+pVar);
	locArr = pVar;
	 
	locArr = locArr.substring(0, locArr.length-1 );
	locArr=locArr.split('#');
	events1=[];
	 
	for (var i = 0; i<locArr.length; i++) {
		delimiter = ',';
		start = 6;
		var result1 = locArr[i].split(delimiter, start+1).join(delimiter);
	 
		latR=result1.split(',');
		 
		pnam=String(latR[0]);
		venue=String(latR[1]);
		venue=venue.replace(/\s/g, ' ');
		art=String(latR[2]);
		Pdeta=String(latR[3]);
		Pdeta=Pdeta.replace('^','\'');
		pTim=String(latR[5]);
	//	pLatLong=String(latR[6]);
		var dt2 = new Date(latR[4]);
		var eDat1= dt2.getDate();
		eMon=dt2.getMonth()+1;
		eYr=dt2.getFullYear();
		 
		events1.push(["",String(eMon),String(eDat1),String(eYr),pTim,venue,pnam,Pdeta,art]);
			 
		}
//	 events1 = events1.sort(function(a,b) {
  //    return a[1] - b[1];
//    });
	
	
//	events1=events1.sort(function(b,a) {
//  return b[1] - a[1] || a[3] - b[3];
//});
	
	
	 
	//alert('len '+events1.length);
	displayArchive();
}	

function displayArchive()
{
 	 
  activePg=2;
document.getElementById("backmenu").style.display="block";
document.getElementById("backmenu").style.visibility="true";
document.getElementById("main").style.visibility="false";
document.getElementById("main").style.display="none";
document.getElementById("mainMenu").style.visibility="false";
document.getElementById("mainMenu").style.display="none";
document.getElementById("dl_btn").style.display="none";
document.getElementById("dl_btn").style.visibility="false";
document.getElementById("calendar").style.display="none";
document.getElementById("calendar").style.visibility="false"; 
document.getElementById("archive").style.visibility="true";
document.getElementById("archive").style.display="block";
document.getElementById("xPort").style.display="none";
document.getElementById("xPort").style.visibility="false";
document.getElementById("lst_mnu").style.display="none";
document.getElementById("lst_mnu").style.visibility="false";
document.getElementById("category").style.display="none";
document.getElementById("category").style.visibility="false";
 document.getElementById("map").style.display="none";
document.getElementById("map").style.visibility="false";	
 
		//alert('in');
prevyr='';	
		
		
		
	var pdfTxt="<table border=1 width='100%' cellpadding=0 cellspacing=0  style='font-size: 11px'><tr height='50px'><td colspan=4 align='center'>Archive </td></tr>";
	pdfTxt+="<tr><td>Date</td><td>Venue</td><td>Program</td><td>Artist</td></tr>";
	for (var i = 0; i < events1.length; i++) {
			
		if(events1[i][3]!=prevyr  && i!=0)	
	       {
			pdfTxt+="<tr height='20px' bgcolor='#fafbfc'><td colspan=4>&nbsp;</td></tr>";
		}	
		pdfTxt+="<tr height='50px'><td>"+events1[i][2]+"/"+events1[i][1]+"/"+events1[i][3].substring(2, 4)+"</td><td>"+events1[i][5]+"</td><td>"+events1[i][6]+"</td><td>"+events1[i][8]+"<tr>";
		
		prevyr=events1[i][3];	
		
	}
	
 
		
	  document.getElementById('archive').innerHTML =pdfTxt+"</table>";
// document.getElementById('archive').innerHTML ='iiiiiiisdfsdfsdfsdf';
}
		
function stringToDate(_date,_format,_delimiter)
{
            var formatLowerCase=_format.toLowerCase();
            var formatItems=formatLowerCase.split(_delimiter);
            var dateItems=_date.split(_delimiter);
            var monthIndex=formatItems.indexOf("mm");
            var dayIndex=formatItems.indexOf("dd");
            var yearIndex=formatItems.indexOf("yyyy");
            var month=parseInt(dateItems[monthIndex]);
            month-=1;
            var formatedDate = new Date(dateItems[yearIndex],month,dateItems[dayIndex]);
            return formatedDate;
}

//var d = new Date();
var weekday = new Array(7);
weekday[0] =  "Sun";
weekday[1] = "Mon";
weekday[2] = "Tue";
weekday[3] = "Wed";
weekday[4] = "Thu";
weekday[5] = "Fri";
weekday[6] = "Sat";
		
var monthNames = ["Jan", "Feb", "Mar", "Apr", "May", "Jun",
  "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"
];

function rateApp()
{
//alert("in");
LaunchReview.launch(appId, function(){
    alert("Successfully launched store app");
},function(err){
    alert("Error launching store app: " + err);
});
	
}
function chkFavorite()
	{
	var favS= window.localStorage.getItem("favShows");
	var NotfavS= window.localStorage.getItem("NotfavShows");
//		 favS= favS.replace(/undefined/g, "");
//		  favS= favS.replace(/null/g, "");
//		 NotfavS= NotfavS.replace(/undefined/g, "");
//		  NotfavS= NotfavS.replace(/null/g, "");
		alert('fav'+favS);	
		alert('not fav'+NotfavS);	
//		favS = favS.substring(0, favS.length-1 );
//	favS=favS.split('!');
		
//		fArr=[];
//		ori=[];
//	for (var i = 0, len = favS.length; i < len; i++) {
//	 	latR1= favS[i].split('^');
//	 	//alert('latr1'+latR1);
//		pDat1=latR1[0];
//		pnam1=latR1[1];
//		fArr.push([pDat1,pnam1]);
		  
//	}
//		 alert('far'+fArr);
//var ori=multiDimensionalUnique(fArr);
//for (var i = 0, len =ori.length; i < len; i++) {
	 //	alert(ori[i][0]);
 
		  
//	}
		
		
		
		}
function profile()
	{
		 
		$("#arSrch").html("");
		 
		  $('#category').hide();
			$('#map').hide();
		 $('#calendar').hide();
		  $('#dl_btn').hide();
		  $('#lst_mnu').hide();
		 
			$('#dl_btn1').hide();
			 $('#xPort').hide();
			  $('#xPort1').hide();
			   $('#tab').hide();
 
document.getElementById("archive").style.visibility="true";
document.getElementById("archive").style.display="block";
 	
	// setFav();
	//  window.localStorage.setItem('favShows',favAddStr);
 var favS= window.localStorage.getItem("favShows");
//	var NotfavS= window.localStorage.getItem("NotfavShows");	
	//alert( favS);	
//		alert( NotfavS);	
	//	  favS= favS.replace(/undefined/g, "");
	//	  favS= favS.replace(/null/g, "");
//		 NotfavS= NotfavS.replace(/undefined/g, "");
//		  NotfavS= NotfavS.replace(/null/g, "");
//	 	 alert( favS);
		
	//	favS1=favS.split('!');
//		NotfavS1=NotfavS.split('!');
		 //alert( favS);
		fArr=[];
//	ori=[];
		
	if(favS !=null && typeof(favS) !='undefined')
	{
		favS1=favS.split('!');
	for (var i = 0, len = favS1.length; i < len-1; i++) {
 
 		latR1= favS1[i];
	 	  latR1= latR1.slice(1);
	 	//alert('latR'+latR1);
		if(latR1 != '')
		{
		fArr.push([latR1]);
		}
		
 		  
 	}
		// alert(  checkArray(fArr));
		var ori=multiDimensionalUnique(fArr);
		for (var i = 0, len = fArr.length; i < len; i++) {
		//str1=fArr[i];
		
 		  
 	}
	}	
	//	alert('farr  '+fArr.length);
		
	  if(fArr.length >0)
	 {
		var strFav="<table border=0 width='100%' cellpadding=0 cellspacing=0 bgcolor='#fafbfc' style='font-size: 13px;font-family:Trebuchet MS, Helvetica, sans-serif';><tr height='50px'><td align='center'>My Favorites </td></tr>";
	 
	      for (var i = 0; i < fArr.length; i++) {
			s=String(fArr[i]);
		  //    alert(s);
			 while(s.charAt(0) === ',')
				{
			 s = s.substr(1);
				}
	 		s=s.replace(/_/g, " ");
		      s=s.replace('^', " - ");
		    //     alert(s);
	       	strFav+="<tr height='50px'><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+s+"</td><tr>";
		
	}
	
 		
	}
	else
	{
		strFav="<table border=0 width='100%'><tr height='60px'><td  align='center'>No Favorites</td></tr>";
	
	}
		
		 document.getElementById('archive').innerHTML =strFav+"</table>";

		 
}

		
		function checkArray(my_arr){
   for(var i=0;i<my_arr.length;i++){
       if(my_arr[i] === "")   
          return false;
   }
   return true;
}
		
		function multiDimensionalUnique(arr) {
    var uniques = [];
    var itemsFound = {};
    for(var i = 0, l = arr.length; i < l; i++) {
        var stringified = JSON.stringify(arr[i]);
        if(itemsFound[stringified]) { continue; }
        uniques.push(arr[i]);
        itemsFound[stringified] = true;
    }
    return uniques;
}


		
</script>
</head>
 

<body style="background-color: transparent;" onload='init();'> 
<nav role='main' class="nav">
                    
          <ul>
		  <li> <a id="myLink" href="#" onclick="category();" class="ssm-toggle-nav">Home</a>
		
      		<!--   <li> <a id="myLink" href="#" onclick="uploadSchedule();" class="ssm-toggle-nav">Upload Scehdule</a>-->
 		  
		   <li> <a id="myLink" href="#" onclick="archive();" class="ssm-toggle-nav">Archive</a>
              
                  <li> <a id="myLink" href="#" onclick="rateApp();" class="ssm-toggle-nav">Rate MMM</a>
		    <li> <a id="myLink" href="#" onclick="login();" class="ssm-toggle-nav">Login/Register</a>
          </ul>
       
        </nav>

	 	<nav role='sub' class="nav">
                    
          <ul>
		  <li> <a id="myLink" href="#" onclick="category();" class="ssm-toggle-nav">Home</a>
		
      		<!--   <li> <a id="myLink" href="#" onclick="uploadSchedule();" class="ssm-toggle-nav">Upload Scehdule</a>-->
 		  
		   <li> <a id="myLink" href="#" onclick="archive();" class="ssm-toggle-nav">Archive</a>
              
                  <li> <a id="myLink" href="#" onclick="rateApp();" class="ssm-toggle-nav">Rate MMM</a>
		    <li> <a id="myLink" href="#" onclick="profile();" class="ssm-toggle-nav">Profile</a>
          </ul>
       
        </nav>
         <div id=main >
            <table border=0 width='100%' cellpadding="0" cellspacing="0"  bgcolor="#0c9db7"><tr height='70px' style='color:#ffffff'><td style='vertical-align: middle;' >&nbsp;&nbsp;
         <a href="#" class="ssm-toggle-nav"  style='text-decoration: none;  font-size: 15px;color: white;'  title="open nav">&#9776;</a></td><td  align='center'><font size=3 color='#ffffff'><b>Madras Music & Miscellany</b></font></td><td><button id='artist' class='btn2'><img src='search.png' style='border:none; outline: none; width :25px; height:25px;vertical-align:middle'></button>&nbsp;</td></tr></table>
        </div>
<div id='backmenu' class='backmenu'>
	 
	
	      <table border=0 width='100%' bgcolor='#0c9db7'><tr height='70px'><td style='vertical-align: top;'>&nbsp;&nbsp;
           <font size=5><b><a href="#" onclick="backSt();" style='text-decoration: none; color: #ffffff;' title="back">&#x003C;</a></b></font></td><td width=99% align='center'><b><font size=3 color='#ffffff'>Madras Music & Miscellany</font></b></td></tr></table> 
		</div>
        <!-- jQuery library (served from Google) -->
         <div class="ssm-overlay ssm-toggle-nav"></div>
	<!--<div id="autocomplete-container">  
  <input type="text" autofocus="true" name="autofocus sample" placeholder="Search Artist" id="autocomplete-input"></input>
  <ul id="autocomplete-results">
  </ul>
</div>
  
    <script  src="index.js"></script>-->

	<div id='searchmenu' class='searchmenu' >
	 
	
	  
	 
	 
	  <div id='inputDiv' class='inputDiv'>
      
      <form id="form1">
         <input type="text" id="input1"  class='deletable'  style='color :black;width :300px;left: 10px;height: 40px;' placeholder="Search Artist" />

      </form>
    </div>

 <!--<div id='msgs' class="inputDiv" style='color:red;font-size:10pt;font-weight:normal;'>
    </div> -->
<!--<input id='reslt' style='color :red;' >-->
	 
		</div>
	
    <div id='artDisplay' class= 'artDisplay'>
</div>
	
	<div id='mainMenu' class='mainMenu'>	
	 
<table border="0"   cellpadding="0" cellspacing="0" width="100%">
	<tr height='25px'  bgcolor='#0c9db7'><td align=center>
	<div class="tab">
 
  <button class="tablinks" onclick="openCity(event, 'Tokyo')" id="defaultOpen">Events</button>
  <button class="tablinks" onclick="openCity(event, 'London')">Calendar</button>
  <button class="tablinks" onclick="openCity(event, 'Paris')">Venue</button>
		
</div>
		</td></tr></table>
</div>
<div id="London" class="tabcontent">
<!--  <span onclick="this.parentElement.style.display='none'" class="topright">x</span>-->
   
</div>

<div id="Paris" class="tabcontent">
<!--   <span onclick="this.parentElement.style.display='none'" class="topright">x</span>-->
  
</div>

<div id="Tokyo" class="tabcontent">
 <!--  <span onclick="this.parentElement.style.display='none'" class="topright">x</span>-->
 
</div>

	
	
	
	<div id='category' class='category'>
         <!--                   <div class = "ui-widget">
          
         <input id = "automplete-1" placeholder="Artist" >
      </div> -->
		<!--<font size=1 face='arial'>Browse by Category</font><br><br>-->
		<!-- <input type="text" autofocus="true" name="autofocus sample" placeholder="Search Artist" id="autocomplete-input"></input><br><br>-->
		 
	   <table id='cat_tbl' width='100%' border=0 cellpadding=0 cellpadding=0 >
		   <tr><td onclick='eventList(1);'><button onclick='eventList(1);' class='btn2'><img src='concert.png'  style="vertical-align:middle"  bordercolor='FFFFFF'><span>Concerts</span></button></td><td width='7%'><button onclick='eventList(1);' class='btn2'><img src='arrow.png'  width=10px height=10px style="vertical-align:middle"></button><font color='white'>&nbsp;&nbsp;&nbsp;&nbsp;11</font></td></tr>
		   <tr valign="top"><td colspan=2><hr size=1 color='#ececec'></td></tr>
		    <tr><td  onclick='eventList(2);'><button onclick='eventList(2);' class='btn2' ><img src='dance.png'   style="vertical-align:middle"  bordercolor='FFFFFF'><span>Dance</span></button></td><td width='7%'><button onclick='eventList(2);' class='btn2' ><img src='arrow.png'   width=10px height=10px style="vertical-align:middle"  bordercolor='FFFFFF'></button>&nbsp;&nbsp;&nbsp;</td></tr>
		    <tr valign="top"><td  colspan=2><hr size=1 color='#ececec'></td></tr>
		   <tr><td  onclick='eventList(3);'><button onclick='eventList(3);' class='btn2'><img src='drama.png'   style="vertical-align:middle"  bordercolor='FFFFFF'><span>Drama</span></button></td><td width='7%'><button onclick='eventList(3);' class='btn2' ><img src='arrow.png'   width=10px height=10px style="vertical-align:middle"  bordercolor='FFFFFF'></button>&nbsp;&nbsp;&nbsp;</td></tr>
		   <tr valign="top"><td  colspan=2><hr size=1 color='#ececec'></td></tr>
		    <tr><td  onclick='eventList(4);'><button onclick='eventList(4);' class='btn2' ><img src='lec-dem.png'   style="vertical-align:middle"  bordercolor='FFFFFF'><span>Lec-Dem</span></button></td><td width='7%'><button onclick='eventList(4);' class='btn2' ><img src='arrow.png'   width=10px height=10px style="vertical-align:middle"  bordercolor='FFFFFF'></button>&nbsp;&nbsp;&nbsp;</td></tr>
		    <tr valign="top"><td  colspan=2><hr size=1 color='#ececec'></td></tr>
		   <tr><td  onclick='eventList(5);'><button onclick='eventList(5);' class='btn2'><img src='harikatha.png'   style="vertical-align:middle"  bordercolor='FFFFFF'><span>Harikatha</span></button></td><td width='7%'><button onclick='eventList(5);' class='btn2' ><img src='arrow.png'  width=10px height=10px  style="vertical-align:middle"  bordercolor='FFFFFF'></button>&nbsp;&nbsp;&nbsp;</td></tr>
		   <tr valign="top"><td  colspan=2><hr size=1 color='#ececec'></td></tr>
		    <tr><td  onclick='eventList(6);'><button onclick='eventList(6);' class='btn2' ><img src='meetup.png'   style="vertical-align:middle"  bordercolor='FFFFFF'><span>Meetup</span></button></td><td width='7%'><button onclick='eventList(6);' class='btn2' ><img src='arrow.png'  width=10px height=10px style="vertical-align:middle"  bordercolor='FFFFFF'></button>&nbsp;&nbsp;&nbsp;</td></tr>
		    <tr valign="top"><td  colspan=2><hr size=1 color='#ececec'></td></tr>
		   
		</table>
		</div>	
	 
	
	<table id="evtcal" border="0" cellpadding="0" cellspacing="0" width="100%"><tr>
			<td style="padding: 3px;" align="center" valign="top" width="314">
				<div id="calendar"> <!--  Dynamically Filled --></div> 
				
			</td></tr></table>
<div id='lst_mnu' align='left'> 	</div>
	<!--<div id="previewImage">
    </div>-->
    <div id='archive'></div>  
	<div id='calEvent'>
			 
		<div id='left1' class="left1"></div>
		<div id='right1' class="right1"></div>
		<div id='common1' class="common1"></div>
   
				
	</div>

	<div id='login' align='center' class='login'>
		
	 
	   <table align='center' border=0 cellpadding=0 cellpadding=0  >
		   <tr height='130px'> <td>Madras Music & Miscellany</td></tr>
		   <tr > <td><input type="text" style='border: 0;  outline: 0;  background: transparent;  border-bottom: 1px solid black;width:100%;height:34px;padding:6px 12px;font-size:14px;' id="usrname" placeholder="Email ID" ></td></tr>	
	 <tr > <td><input type="password" style='border: 0;  outline: 0;  background: transparent;  border-bottom: 1px solid black;width:100%;height:34px;padding:6px 12px;font-size:14px;' id="usrpwd" placeholder="*******" ></td></tr>
		    <tr><td>&nbsp;</td></tr>
		   <tr><td align=right> <a href="#" onclick='forgot_pass(); ' style='text-decoration: none;color: black;'><font size=2>Forgot Password?</font></a></td></tr>
		   <tr><td>&nbsp;</td></tr>
	<tr height='40px'><td> <button id='display' class="btn34" onclick='ajaxCall(this.id);'>Login</button>&nbsp;	&nbsp;&nbsp;<button id='register' class="btn34" onclick='ajaxCall(this.id);'>Register</button></td></tr>
		   
		</table>
		 
		
	</div>
 <div id='map-container'>
 <div id='map'  width='300px' height='300px'>
  
  </div>
</div>
	<div class="dl_btn" id='dl_btn' align='center'>
    
 <div style="float: left; font-size: 9pt; width: 33%;"> <button class='btn1'  onclick='calAdd();'><img src="cal1.png"></button>
    <div style='font-size: 9pt;' >Calendar</div></div>
 <div style="float: left; font-size: 9pt;width: 33%;"><button class='btn1'  onclick='printData();'><img src="pdf.png"></button>
    <div style='font-size: 9pt;'>Download</div></div>
 <div style="float: left; font-size: 9pt;width: 33%;"><button class='btn1'  onclick='share();'><img src="share1.png"></button>
    <div style='font-size: 9pt;'>Share</div></div>
 
 <br style="clear: left;" />
</div>
 
	<div id='xPort' >     </div>

		<div id='dl_btn1'></div>
		 
	
			<div id='det' align='center' style="background-color:white">
				 
				<form id="eventform" name="eventform" action="#" method="get">
					<textarea name="eventlist"  style="border: none" cols="40" rows="20" wrap="soft" readonly>					</textarea>
				</form>
			</div>
	 
 <textarea id="rest1" class="hideDontTakeUpSpace" rows=1 cols=40></textarea> 

<div id='xPort1'>     </div>
 <div id='csv' class='csv'>
  
	  
      </div>

 <textarea id="rest2" class="hideDontTakeUpSpace"  rows=1 cols=40 readonly></textarea> 
<textarea id="storge" class="hideDontTakeUpSpace"  rows=1 cols=2 readonly></textarea> 
</body>
</html>


 
